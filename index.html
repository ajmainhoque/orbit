<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CommonSat Prototype</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { font-family: 'Inter', sans-serif; -webkit-font-smoothing: antialiased; background-color: #F3F4F6; }
        .screen { display: none; animation: fadeIn 0.3s; height: 100%; overflow-y: auto; }
        .screen.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .screen::-webkit-scrollbar { width: 4px; }
        .screen::-webkit-scrollbar-track { background: transparent; }
        .screen::-webkit-scrollbar-thumb { background: #4B5563; border-radius: 10px; }
        .map-container { height: 250px; width: 100%; background-color: #1F2937; border-radius: 0.75rem; border: 1px solid #4F4F4F; }
        .leaflet-container { border-radius: 0.75rem; }
        .leaflet-control-layers, .leaflet-control-zoom { border: 1px solid #4B5563 !important; background: rgba(31, 41, 55, 0.8) !important; backdrop-filter: blur(4px); border-radius: 8px; color: #F9FAFB; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); }
        .leaflet-control-layers-toggle { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95a15.65 15.65 0 00-1.38-3.39A8.02 8.02 0 0118.92 8zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91 3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.39A7.99 7.99 0 015.08 16zm2.95-8H5.08a7.99 7.99 0 014.21-3.39c-.6 1.02-1.06 2.15-1.38 3.39zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08-2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2s.07-1.34.16-2h4.68c.09.66.16 1.32.16 2s-.07 1.34-.16 2zm.25 5.39c.6-1.02 1.06-2.15 1.38-3.39h2.95a8.02 8.02 0 01-4.33 3.39zM16.38 14h3.38c.16-.64.26-1.31.26-2s-.1-1.36-.26-2h-3.38c.08.66.14 1.32.14 2s-.06 1.34-.14 2z'/%3E%3C/svg%3E") !important; }
        .sidebar { transition: transform 0.3s ease-in-out; }
        .overlay { transition: opacity 0.3s ease-in-out; }
        #chat-modal { transition: opacity 0.3s, transform 0.3s; }
    </style>
    <script>
        tailwind.config = { theme: { extend: { colors: { 'brand-dark': '#212121', 'brand-card': '#333333', 'brand-border': '#4F4F4F', 'brand-accent': '#2D9CDB', 'brand-primary': '#BB86FC', 'brand-secondary': '#BDBDBD', 'brand-light': '#E0E0E0', 'brand-red': '#CF6679', 'sidebar-bg': '#1F2336' } } } }
    </script>
</head>
<body class="p-4">
    <div class="w-full max-w-sm mx-auto h-[850px] bg-brand-dark rounded-[40px] shadow-2xl border-8 border-black overflow-hidden flex flex-col relative">
        
        <div id="overlay" class="overlay absolute inset-0 bg-black bg-opacity-60 z-40 opacity-0 pointer-events-none"></div>

        <div id="sidebar" class="sidebar absolute inset-y-0 left-0 w-3/4 max-w-xs bg-sidebar-bg z-50 transform -translate-x-full shadow-lg">
            <div class="p-4 flex flex-col h-full">
                <div class="flex items-center justify-between pb-4">
                    <div class="flex items-center space-x-3">
                        <svg class="w-8 h-8 text-white" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 12L21 3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M3 21L12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 3C16.9706 3 21 7.02944 21 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" opacity="0.5"/>
                        </svg>
                        <h1 class="text-xl font-bold text-white">CommonSat</h1>
                    </div>
                    <button id="close-sidebar" class="text-brand-secondary hover:text-white text-3xl">&times;</button>
                </div>
                <nav class="mt-6 flex-1">
                     <ul class="space-y-2">
                        <li><a href="#" class="sidebar-link flex items-center p-3 text-brand-light rounded-lg hover:bg-white/5" data-target="products-screen"><svg class="w-6 h-6 mr-4 text-brand-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg><span>Products & Pricing</span></a></li>
                        <li><a href="#" class="sidebar-link flex items-center p-3 text-brand-light rounded-lg hover:bg-white/5" data-target="partners-screen"><svg class="w-6 h-6 mr-4 text-brand-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a3.001 3.001 0 015.688 0M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 0c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"></path></svg><span>Partners & Data</span></a></li>
                        <li><a href="#" class="sidebar-link flex items-center p-3 text-brand-light rounded-lg hover:bg-white/5" data-target="news-screen"><svg class="w-6 h-6 mr-4 text-brand-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3h3m-3 4h3m-3 4h3m-3 4h3"></path></svg><span>News & Media</span></a></li>
                        <li><a href="#" class="sidebar-link flex items-center p-3 text-brand-light rounded-lg hover:bg-white/5" data-target="blog-screen"><svg class="w-6 h-6 mr-4 text-brand-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg><span>Blog & Education</span></a></li>
                        <li><a href="#" class="sidebar-link flex items-center p-3 text-brand-light rounded-lg hover:bg-white/5" data-target="orbital-screen"><svg class="w-6 h-6 mr-4 text-brand-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.196-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.783-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg><span>Orbital Awareness</span></a></li>
                        <li><a href="#" class="sidebar-link flex items-center p-3 text-brand-light rounded-lg hover:bg-white/5" data-target="support-screen"><svg class="w-6 h-6 mr-4 text-brand-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span>Support & Contact</span></a></li>
                     </ul>
                </nav>
            </div>
        </div>

        <header class="flex items-center justify-between p-4 flex-shrink-0 z-10 bg-brand-dark/80 backdrop-blur-sm border-b border-brand-border">
            <button id="open-sidebar"><svg class="w-7 h-7 text-brand-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button>
            <h1 id="header-title" class="text-xl font-bold text-white">CommonSat</h1>
            <button><img src="https://api.dicebear.com/8.x/micah/svg?seed=DaneshRafin&backgroundColor=BB86FC" alt="User Profile" class="w-8 h-8 rounded-full border-2 border-brand-primary"></button>
        </header>

        <div id="main-content" class="flex-1 overflow-y-auto relative"></div>

        <button id="open-chat-fab" class="absolute bottom-24 right-6 bg-brand-primary h-14 w-14 rounded-full shadow-lg flex items-center justify-center text-white z-20 hover:bg-purple-500 transition-colors">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>
        </button>

        <nav class="grid grid-cols-5 gap-1 p-2 border-t border-brand-border bg-brand-dark/90 backdrop-blur-sm flex-shrink-0 z-10">
            <a href="#" class="nav-link flex flex-col items-center text-brand-primary space-y-1" data-target="home-screen"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg><span class="text-xs font-semibold">Home</span></a>
            <a href="#" class="nav-link flex flex-col items-center text-brand-secondary hover:text-brand-primary space-y-1" data-target="cropwatch-screen"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 20A7 7 0 0 1 4 13V6a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v7a7 7 0 0 1-7 7h-1z"></path><path d="M12 14a3 3 0 0 0-3-3v4a3 3 0 0 0 6 0v-4a3 3 0 0 0-3 3z"></path></svg><span class="text-xs">Crop</span></a>
            <a href="#" class="nav-link flex flex-col items-center text-brand-secondary hover:text-brand-primary space-y-1" data-target="marinewatch-screen"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.5 16.5c-1-1.5.5-3.5 2.5-3s4.5-1.5 6.5 0c2 1.5 4.5 2.5 6.5 1s3-2 4-3.5"></path><path d="M2.5 10c-1-1.5.5-3.5 2.5-3s4.5-1.5 6.5 0c2 1.5 4.5 2.5 6.5 1s3-2 4-3.5"></path></svg><span class="text-xs">Marine</span></a>
            <a href="#" class="nav-link flex flex-col items-center text-brand-secondary hover:text-brand-primary space-y-1" data-target="fireguard-screen"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.4 4.7a2.38 2.38 0 00-3.6 2.3 2.38 2.38 0 00 1.5 2.5c1.4.4 2.1 1.6 1.7 2.8-1 2.9-4.4 4.7-7 4.7-2.6 0-6-1.8-7-4.7-.4-1.2.3-2.4 1.7-2.8a2.38 2.38 0 001.5-2.5 2.38 2.38 0 00-3.6-2.3c-.6.5-1 1.2-1.2 2"></path><path d="M14.4 10.7a2.38 2.38 0 00-3.6 2.3 2.38 2.38 0 00 1.5 2.5c1.4.4 2.1 1.6 1.7 2.8-1 2.9-4.4 4.7-7 4.7-2.6 0-6-1.8-7-4.7-.4-1.2.3-2.4 1.7-2.8a2.38 2.38 0 001.5-2.5 2.38 2.38 0 00-3.6-2.3c-.6.5-1 1.2-1.2 2"></path><path d="M10.5 15.5c.3 1 .1 2.1-.5 3"></path><path d="M14.5 9.5c.3 1 .1 2.1-.5 3"></path></svg><span class="text-xs">Fire</span></a>
            <a href="#" class="nav-link flex flex-col items-center text-brand-secondary hover:text-brand-primary space-y-1" data-target="developer-screen"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg><span class="text-xs">Developer</span></a>
        </nav>

        <div id="chat-modal" class="absolute inset-0 bg-brand-dark flex flex-col z-30 opacity-0 pointer-events-none transform scale-95">
            <div class="flex items-center justify-between p-4 border-b border-brand-border">
                <div class="flex items-center space-x-3">
                    <img src="https://api.dicebear.com/8.x/lorelei/svg?seed=AnyaSharma&backgroundColor=2D9CDB" class="w-10 h-10 rounded-full border-2 border-brand-accent">
                    <div>
                        <p class="font-semibold text-white">AI Expert Chat</p>
                        <p class="text-xs text-green-400">Online</p>
                    </div>
                </div>
                <button id="close-chat-modal" class="text-brand-secondary text-3xl">&times;</button>
            </div>
            <div class="flex-1 p-4 space-y-4 overflow-y-auto">
                <div class="flex justify-start"><div class="bg-brand-card p-3 rounded-lg max-w-xs"><p class="text-sm text-brand-light">Hello! I'm your AI Agronomist. Ask me anything about the data you're seeing.</p></div></div>
                <div class="flex justify-end"><div class="bg-brand-primary p-3 rounded-lg max-w-xs"><p class="text-sm text-white">What's the NDMI trend for Riverbend Cluster?</p></div></div>
                 <div class="flex justify-start"><div class="bg-brand-card p-3 rounded-lg max-w-xs"><p class="text-sm text-brand-light">The NDMI has dropped by 12% over the last 7 days, indicating increasing water stress. I recommend verifying soil moisture levels on the ground, especially in the northeast quadrant.</p></div></div>
            </div>
            <div class="p-4 border-t border-brand-border">
                <div class="flex space-x-2">
                    <input type="text" placeholder="Type your message..." class="w-full bg-brand-card text-brand-light p-3 rounded-lg border border-brand-border focus:ring-2 focus:ring-brand-accent text-sm">
                    <button class="bg-brand-accent text-white font-semibold px-4 rounded-lg"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg></button>
                </div>
            </div>
        </div>

    </div>

    <script>
    const screenContents = {
        'home-screen': `<div class="p-4 space-y-4">
            <div class="bg-brand-card rounded-xl shadow-lg border border-brand-border overflow-hidden">
                <img src="https://images.unsplash.com/photo-1541185934-3b7956ea6239?q=80&w=600&auto=format&fit=crop" class="w-full h-32 object-cover">
                <div class="p-4">
                    <p class="text-sm text-brand-secondary">FEATURED INSIGHT</p>
                    <h3 class="font-semibold text-white mt-1">Hurricane Approaching Coast</h3>
                    <p class="text-sm text-brand-light mt-1">Near real-time tracking via NASA Worldview shows the storm is intensifying.</p>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-4">
                 <div class="bg-brand-card p-3 rounded-xl border border-brand-border text-center">
                    <p class="text-sm text-brand-secondary">Alerts This Week</p>
                    <p class="text-2xl font-bold text-brand-red">7</p>
                </div>
                 <div class="bg-brand-card p-3 rounded-xl border border-brand-border text-center">
                    <p class="text-sm text-brand-secondary">New Scenes Added</p>
                    <p class="text-2xl font-bold text-brand-accent">1,204</p>
                </div>
            </div>
            <div class="bg-brand-card rounded-xl shadow-lg border border-brand-border overflow-hidden relative">
                <img src="https://images.unsplash.com/photo-1500382017468-9049fed747ef?q=80&w=600&auto=format&fit=crop" class="absolute inset-0 w-full h-full object-cover opacity-20">
                <div class="relative p-4">
                    <h3 class="font-semibold text-white mb-3">Recommended Tasks</h3>
                    <div class="space-y-3">
                        <div class="flex items-center space-x-3"><div class="w-10 h-10 bg-green-500/20 rounded-lg flex items-center justify-center text-green-400"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 20A7 7 0 0 1 4 13V6a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v7a7 7 0 0 1-7 7h-1z"></path></svg></div><p class="text-sm text-brand-light">Verify soil moisture in North Field.</p></div>
                        <div class="flex items-center space-x-3"><div class="w-10 h-10 bg-red-500/20 rounded-lg flex items-center justify-center text-red-400"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.4 4.7a2.38 2.38 0 00-3.6 2.3 2.38 2.38 0 00 1.5 2.5c1.4.4 2.1 1.6 1.7 2.8-1 2.9-4.4 4.7-7 4.7-2.6 0-6-1.8-7-4.7-.4-1.2.3-2.4 1.7-2.8a2.38 2.38 0 001.5-2.5 2.38 2.38 0 00-3.6-2.3c-.6.5-1 1.2-1.2 2"></path></svg></div><p class="text-sm text-brand-light">Review thermal anomaly in Sector Gamma.</p></div>
                    </div>
                </div>
            </div>
            <div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border">
                <h3 class="font-semibold text-white mb-2">Community Feed</h3>
                <div class="flex items-start space-x-3 mt-3">
                    <img src="https://api.dicebear.com/8.x/adventurer/svg?seed=FarmerJohnD" class="w-10 h-10 rounded-full bg-gray-700 flex-shrink-0">
                    <div>
                        <p class="font-semibold text-white text-sm">Farmer John D.</p>
                        <p class="text-brand-light text-sm mt-1">Confirmed severe pest infestation on leaves in North Field. Sharing photo for expert review.</p>
                         <img src="https://images.unsplash.com/photo-1621835332852-290447395006?q=80&w=200&auto=format&fit=crop" class="mt-2 rounded-lg w-full h-auto object-cover">
                    </div>
                </div>
            </div>
        </div>`,
        'cropwatch-screen': `<div class="p-4 space-y-4"><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><h2 class="text-lg font-semibold text-white">CropWatch: North Field</h2><p class="text-sm text-brand-secondary">Real-time Health Analysis</p><div id="cropMap" class="map-container mt-3"></div></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><h3 class="font-semibold text-white mb-3">Analysis Tools</h3><div class="grid grid-cols-3 gap-3 text-center"><div class="bg-brand-dark p-3 rounded-lg"><svg class="w-6 h-6 mx-auto text-brand-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><p class="text-xs mt-2 text-brand-light">Irrigation Plan</p></div><div class="bg-brand-dark p-3 rounded-lg"><svg class="w-6 h-6 mx-auto text-brand-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><p class="text-xs mt-2 text-brand-light">Yield Estimate</p></div><div class="bg-brand-dark p-3 rounded-lg"><svg class="w-6 h-6 mx-auto text-brand-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><p class="text-xs mt-2 text-brand-light">Pest Detection</p></div></div></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><h3 class="font-semibold text-white">Soil Moisture Trend</h3><div class="mt-2 h-32"><canvas id="soilMoistureChart"></canvas></div></div></div>`,
        'marinewatch-screen': `<div class="p-4 space-y-4"><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><h2 class="text-lg font-semibold text-white">MarineWatch: Bay of Bengal</h2><p class="text-sm text-brand-secondary">Powered by ESA Copernicus Sentinel data</p><div id="marineMap" class="map-container mt-3"></div></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><h3 class="font-semibold text-white mb-3">Analysis Tools</h3><div class="grid grid-cols-3 gap-3 text-center"><div class="bg-brand-dark p-3 rounded-lg"><svg class="w-6 h-6 mx-auto text-brand-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg><p class="text-xs mt-2 text-brand-light">Vessel Tracking</p></div><div class="bg-brand-dark p-3 rounded-lg"><svg class="w-6 h-6 mx-auto text-brand-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg><p class="text-xs mt-2 text-brand-light">Detect Spills</p></div><div class="bg-brand-dark p-3 rounded-lg"><svg class="w-6 h-6 mx-auto text-brand-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><p class="text-xs mt-2 text-brand-light">Port Activity</p></div></div></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><h3 class="font-semibold text-white">Chlorophyll-a Trend</h3><div class="mt-2 h-32"><canvas id="chloroChart"></canvas></div></div></div>`,
        'fireguard-screen': `<div class="p-4 space-y-4"><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><h2 class="text-lg font-semibold text-white">FireGuard: Sector Gamma</h2><p class="text-sm text-brand-secondary">Active Hotspot Detection</p><div id="fireMap" class="map-container mt-3"></div></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><h3 class="font-semibold text-white mb-3">Analysis Tools</h3><div class="grid grid-cols-3 gap-3 text-center"><div class="bg-brand-dark p-3 rounded-lg"><svg class="w-6 h-6 mx-auto text-brand-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg><p class="text-xs mt-2 text-brand-light">Predict Spread</p></div><div class="bg-brand-dark p-3 rounded-lg"><svg class="w-6 h-6 mx-auto text-brand-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2a4 4 0 00-4-4H3"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17v-2a4 4 0 014-4h2"></path></svg><p class="text-xs mt-2 text-brand-light">Burn Scar Area</p></div><div class="bg-brand-dark p-3 rounded-lg"><svg class="w-6 h-6 mx-auto text-brand-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><p class="text-xs mt-2 text-brand-light">Risk Analysis</p></div></div></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border-2 border-brand-red"><div class="flex items-center space-x-2"><svg class="w-5 h-5 text-brand-red" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.21 3.03-1.742 3.03H4.42c-1.532 0-2.492-1.696-1.742-3.03l5.58-9.92zM9 11a1 1 0 112 0v1a1 1 0 11-2 0v-1zm1-4a1 1 0 00-1 1v2a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg><h3 class="font-semibold text-brand-red">2 Active Hotspots Detected</h3></div><p class="text-xs text-brand-secondary mt-1">Data Source: NASA FIRMS / CSA RADARSAT</p></div></div>`,
        'orbital-screen': `<div class="p-4 space-y-4"><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border relative overflow-hidden"><img src="https://images.unsplash.com/photo-1614726353900-96128816c463?q=80&w=600&auto=format&fit=crop" class="absolute inset-0 w-full h-full object-cover opacity-20"><div class="relative"><h2 class="text-lg font-semibold text-white">Orbital Awareness</h2><p class="text-sm text-brand-secondary">Monitor space infrastructure.</p></div></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><h3 class="font-semibold text-white">Upcoming Satellite Passes</h3><div class="mt-2 space-y-3"><div class="flex justify-between items-center"><p class="text-sm text-brand-light">Sentinel-2 (ESA)</p><p class="text-sm text-brand-accent">Today at 14:30</p></div><div class="flex justify-between items-center"><p class="text-sm text-brand-light">Landsat-9 (NASA/USGS)</p><p class="text-sm text-brand-secondary">Tomorrow at 10:15</p></div><div class="flex justify-between items-center"><p class="text-sm text-brand-light">RADARSAT (CSA)</p><p class="text-sm text-brand-secondary">Tomorrow at 22:00</p></div></div></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><h3 class="font-semibold text-white">Orbital Debris Risk</h3><p class="text-xs text-brand-secondary">Powered by NASA ODPO data</p><div class="text-center mt-2"><p class="text-4xl font-bold text-green-400">LOW</p><p class="text-sm text-brand-secondary"><0.01% probability of debris encounter</p></div></div></div>`,
        'developer-screen': `<div class="p-4 space-y-4"><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border relative overflow-hidden"><img src="https://images.unsplash.com/photo-1534796636912-3b95b3ab5986?q=80&w=600&auto=format&fit=crop" class="absolute inset-0 w-full h-full object-cover opacity-10"><div class="relative"><h2 class="text-lg font-semibold text-white">Developer & Research Hub</h2><p class="text-sm text-brand-secondary">Tools to build, analyze, and innovate.</p></div></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><div class="flex items-center space-x-3"><svg class="w-6 h-6 text-brand-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg><h3 class="font-semibold text-white">API & SDKs</h3></div><div class="flex items-center justify-between mt-3 bg-brand-dark p-2 rounded-lg"><pre class="text-green-400 text-sm overflow-x-auto">cs_live_******************_d4f3</pre><button class="text-brand-secondary hover:text-white p-1"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg></button></div><button class="w-full text-center mt-3 text-sm text-brand-accent hover:underline">View API Documentation</button></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><div class="flex items-center space-x-3"><svg class="w-6 h-6 text-brand-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg><h3 class="font-semibold text-white">Research Workspace</h3></div><p class="text-sm text-brand-secondary mt-2">Access powerful tools for time-series analysis, data collaboration, and exporting for publication.</p><button class="w-full bg-brand-accent/20 text-brand-accent font-semibold py-2 rounded-lg mt-3 hover:bg-brand-accent/30">Launch Workspace</button></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><div class="flex items-center space-x-3"><svg class="w-6 h-6 text-brand-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M12 14l9-5-9-5-9 5 9 5z"></path><path d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14zm-4 6v-7.5l4-2.222 4 2.222V20M12 14.5v5.5m0 0l-4-2.222M12 20l4-2.222"></path></svg><h3 class="font-semibold text-white">Academic & NGO Program</h3></div><p class="text-sm text-brand-secondary mt-2">Access our Professional Tier for free or apply for a research grant to unlock our full potential.</p><button class="w-full bg-brand-accent/20 text-brand-accent font-semibold py-2 rounded-lg mt-3 hover:bg-brand-accent/30">Apply Now</button></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><h3 class="font-semibold text-white">API Usage</h3><div class="w-40 h-40 mx-auto mt-2"><canvas id="apiUsageChart"></canvas></div><p class="text-center text-sm text-brand-light mt-2">1,402 / 10,000 requests</p></div></div>`,
        'products-screen': `<div class="p-4 space-y-4"><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border relative overflow-hidden"><img src="https://images.unsplash.com/photo-1574936145849-f8aa34137843?q=80&w=600&auto=format&fit=crop" class="absolute inset-0 w-full h-full object-cover opacity-10"><div class="relative"><h2 class="text-lg font-semibold text-white">Starter Tier</h2><p class="text-3xl font-bold text-white mt-2">$29 <span class="text-lg font-normal text-brand-secondary">/ month</span></p><ul class="text-brand-light space-y-2 text-sm mt-4"><li>✓ 500 sq km monitoring area</li><li>✓ 2 intelligence modules</li></ul><button class="w-full bg-brand-accent text-white font-semibold py-2 rounded-lg mt-4">Choose Plan</button></div></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border relative overflow-hidden"><img src="https://images.unsplash.com/photo-1590283603385-17ffb3a7f29f?q=80&w=600&auto=format&fit=crop" class="absolute inset-0 w-full h-full object-cover opacity-10"><div class="relative"><h2 class="text-lg font-semibold text-white">Enterprise Tier</h2><p class="text-3xl font-bold text-white mt-2">$499 <span class="text-lg font-normal text-brand-secondary">/ month</span></p><ul class="text-brand-light space-y-2 text-sm mt-4"><li>✓ Unlimited monitoring area</li><li>✓ All modules + beta features</li></ul><button class="w-full bg-brand-primary text-white font-semibold py-2 rounded-lg mt-4">Contact Sales</button></div></div></div>`,
        'partners-screen': `<div class="p-4 space-y-4"><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><h2 class="text-lg font-semibold text-white">Partners & Data</h2><p class="text-sm text-brand-secondary">Our platform is built on world-class public & private data.</p></div><div class="bg-brand-card p-4 rounded-xl flex items-center space-x-4 shadow-lg border border-brand-border"><img src="https://upload.wikimedia.org/wikipedia/commons/e/e5/NASA_logo.svg" class="w-12 h-12"><div class="flex-1"><h3 class="font-semibold text-white">NASA</h3><p class="text-sm text-brand-secondary mt-1">Open Data Portal, Worldview, and ODPO for debris management.</p></div></div><div class="bg-brand-card p-4 rounded-xl flex items-center space-x-4 shadow-lg border border-brand-border"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f9/USGS_logo.svg/2048px-USGS_logo.svg.png" class="w-12 h-12"><div class="flex-1"><h3 class="font-semibold text-white">USGS</h3><p class="text-sm text-brand-secondary mt-1">50+ year Landsat archive for historical analysis via EarthExplorer.</p></div></div><div class="bg-brand-card p-4 rounded-xl flex items-center space-x-4 shadow-lg border border-brand-border"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b5/ESA_logo.svg/1200px-ESA_logo.svg.png" class="w-12 h-12"><div class="flex-1"><h3 class="font-semibold text-white">ESA</h3><p class="text-sm text-brand-secondary mt-1">Copernicus Data Space Ecosystem for high-resolution Sentinel data.</p></div></div><div class="bg-brand-card p-4 rounded-xl flex items-center space-x-4 shadow-lg border border-brand-border"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d7/CSA-ASC_logo.svg/1280px-CSA-ASC_logo.svg.png" class="w-12 h-12"><div class="flex-1"><h3 class="font-semibold text-white">CSA</h3><p class="text-sm text-brand-secondary mt-1">Canadian Earth observation technologies for resource management.</p></div></div></div>`,
        'news-screen': `<div class="p-4 space-y-4"><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><h2 class="text-lg font-semibold text-white">News & Media</h2><p class="text-sm text-brand-secondary">The latest updates from CommonSat and our partners.</p></div><div class="bg-brand-card rounded-xl shadow-lg border border-brand-border overflow-hidden"><img src="https://images.unsplash.com/photo-1634453737283-c5b6c5e2d_53c?q=80&w=600&auto=format&fit=crop" alt="ESA Sentinel Satellite" class="w-full h-32 object-cover"><div class="p-4"><p class="text-sm text-brand-secondary">Oct 05, 2025</p><h3 class="font-semibold text-white mt-1">CommonSat Partners with ESA for Copernicus Data Integration</h3><p class="text-sm text-brand-light mt-2">A landmark partnership to bring the full power of the high-resolution Sentinel satellite constellation to CommonSat users worldwide.</p></div></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><p class="text-sm text-brand-secondary">Sep 28, 2025</p><h3 class="font-semibold text-white mt-1">How USGS Landsat Data is Powering 50 Years of Agricultural Insights</h3></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><p class="text-sm text-brand-secondary">Sep 15, 2025</p><h3 class="font-semibold text-white mt-1">NASA and CommonSat Collaborate on Near Real-Time Wildfire Tracking</h3></div></div>`,
        'support-screen': `<div class="p-4 space-y-4"><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border relative overflow-hidden"><img src="https://images.unsplash.com/photo-1484589065579-248aad0d8b13?q=80&w=600&auto=format&fit=crop" class="absolute inset-0 w-full h-full object-cover opacity-10"><div class="relative"><h2 class="text-lg font-semibold text-white">Support & Contact</h2></div></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><input class="w-full bg-brand-dark text-brand-light placeholder-brand-secondary p-3 rounded-lg border border-brand-border" placeholder="Your Email"><textarea class="w-full bg-brand-dark text-brand-light placeholder-brand-secondary p-3 rounded-lg border border-brand-border mt-3" rows="4" placeholder="Your message..."></textarea><button class="w-full bg-brand-accent text-white font-semibold py-2 rounded-lg mt-3">Send Message</button></div></div>`,
        'blog-screen': `<div class="p-4 space-y-4"><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><h2 class="text-lg font-semibold text-white">Blog & Education</h2><p class="text-sm text-brand-secondary">Learn to interpret satellite intelligence.</p></div><div class="bg-brand-card rounded-xl shadow-lg border border-brand-border overflow-hidden"><img src="https://images.unsplash.com/photo-1560493676-04071c5f467b?q=80&w=600&auto=format&fit=crop" alt="NDVI map" class="w-full h-32 object-cover"><div class="p-4"><p class="text-sm text-brand-secondary">FEATURED GUIDE</p><h3 class="font-semibold text-white mt-1">How to Read an NDVI Map</h3><p class="text-sm text-brand-light mt-2">Unlock the secrets of crop health. Learn what the green, yellow, and red on your CropWatch map really mean for your fields.</p></div></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><p class="text-sm text-brand-secondary">CASE STUDY</p><h3 class="font-semibold text-white mt-1">Tracking Amazon Deforestation with Landsat</h3><p class="text-sm text-brand-light mt-2">See how decades of USGS data provides invaluable insights into long-term environmental change.</p></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><p class="text-sm text-brand-secondary">FUNDAMENTALS</p><h3 class="font-semibold text-white mt-1">Understanding Satellite Image Resolution</h3><p class="text-sm text-brand-light mt-2">What's the difference between 30m, 10m, and 50cm resolution? Learn which is right for your needs.</p></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><p class="text-sm text-brand-secondary">DATA SPOTLIGHT</p><h3 class="font-semibold text-white mt-1">The Power of NASA Worldview</h3><p class="text-sm text-brand-light mt-2">Explore how near real-time imagery, often available within 3 hours, powers our instant alerts.</p></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><p class="text-sm text-brand-secondary">Getting Started</p><h3 class="font-semibold text-white mt-1">Understanding Thermal Data for Fire Detection</h3></div><div class="bg-brand-card p-4 rounded-xl shadow-lg border border-brand-border"><p class="text-sm text-brand-secondary">Advanced Topics</p><h3 class="font-semibold text-white mt-1">What is Synthetic Aperture Radar (SAR)?</h3></div></div>`,
    };

    const maps = {};
    const charts = {};

    function initMap(mapId, view, zoom, tileUrl, tileAttribution) {
        if (maps[mapId]) { maps[mapId].invalidateSize(); return maps[mapId]; }
        const map = L.map(mapId, { zoomControl: false }).setView(view, zoom);
        L.tileLayer(tileUrl, { attribution: tileAttribution }).addTo(map);
        maps[mapId] = map;
        return map;
    }

    function initCharts() {
        Chart.defaults.color = '#BDBDBD';
        
        const soilCtx = document.getElementById('soilMoistureChart');
        if (soilCtx && !charts.soil) {
            charts.soil = new Chart(soilCtx, {type: 'line', data: {labels: ['-14d', '-7d', 'Today'], datasets: [{label: 'Soil Moisture %', data: [48, 42, 45], borderColor: '#2D9CDB', tension: 0.2}]}, options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: false, grid: { color: '#4F4F4F' } }, x: { grid: { color: '#4F4F4F' } } }}});
        }

        const chloroCtx = document.getElementById('chloroChart');
        if (chloroCtx && !charts.chloro) {
            charts.chloro = new Chart(chloroCtx, {type: 'bar', data: {labels: ['Area A', 'Area B', 'Area C'], datasets: [{label: 'mg/m³', data: [0.8, 1.5, 0.5], backgroundColor: '#2D9CDB'}]}, options: { responsive: true, maintainAspectRatio: false, scales: { y: { grid: { color: '#4F4F4F' } }, x: { grid: { color: '#4F4F4F' } } }}});
        }
        
        const riskCtx = document.getElementById('riskChart');
        if (riskCtx && !charts.risk) {
            charts.risk = new Chart(riskCtx, {type: 'doughnut', data: {labels: ['Risk', ''], datasets: [{data: [75, 25], backgroundColor: ['#CF6679', '#4F4F4F'], borderWidth: 0}]}, options: {responsive: true, cutout: '70%', plugins: { legend: { display: false } } } });
        }

        const apiCtx = document.getElementById('apiUsageChart');
        if (apiCtx && !charts.api) {
            charts.api = new Chart(apiCtx, {type: 'doughnut', data: {labels: ['Used', 'Remaining'], datasets: [{data: [1402, 8598], backgroundColor: ['#BB86FC', '#4F4F4F'], borderWidth: 0}]}, options: {responsive: true, cutout: '70%'} });
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        const mainContent = document.getElementById('main-content');
        
        function showScreen(targetId) {
            mainContent.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            let targetScreen = document.getElementById(targetId);
            if (!targetScreen) {
                targetScreen = document.createElement('main');
                targetScreen.id = targetId;
                targetScreen.className = 'screen';
                targetScreen.innerHTML = screenContents[targetId] || ``;
                mainContent.appendChild(targetScreen);
            }
            targetScreen.classList.add('active');
            
            setTimeout(() => {
                if (targetId === 'cropwatch-screen') {
                    const map = initMap('cropMap', [38.8, -99.3], 13, 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', 'Esri');
                    const healthOverlay = L.imageOverlay('https://i.imgur.com/tB5g2P4.png', [[38.85, -99.35], [38.75, -99.25]], { opacity: 0.7 }).addTo(map);
                    document.getElementById('year-slider')?.addEventListener('input', (e) => healthOverlay.setOpacity(e.target.value));
                }
                if (targetId === 'marinewatch-screen') {
                    const map = initMap('marineMap', [22.2, 91.8], 11, 'https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', 'CARTO');
                    const algaeIcon = L.divIcon({className: 'text-green-400', html: `<svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z" clip-rule="evenodd"></path></svg>`});
                    L.marker([22.25, 91.85], {icon: algaeIcon}).addTo(map).bindPopup("<b>Algal Bloom Detected</b><br>Source: NASA Worldview");
                }
                if (targetId === 'fireguard-screen') {
                     const map = initMap('fireMap', [34.05, -118.24], 9, 'https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', 'CARTO');
                     const fireIcon = L.divIcon({className: 'text-red-500', html: `<svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5.121l1.733-1.732a1 1 0 111.414 1.414l-3.5 3.5a1 1 0 01-1.414 0l-3.5-3.5a1 1 0 111.414-1.414L10 7.121V2a1 1 0 011.3-.954zM9 12.45V18a1 1 0 11-2 0v-5.55a3.001 3.001 0 115.658-2.02l.142.283a3.001 3.001 0 01-2.658 4.214z" clip-rule="evenodd"></path></svg>`});
                     L.marker([34.1, -118.3], {icon: fireIcon}).addTo(map).bindPopup("<b>Hotspot Detected</b><br>Source: NASA FIRMS");
                }
                initCharts();
            }, 50);
        }
        
        document.querySelectorAll('.nav-link, .sidebar-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.dataset.target;
                showScreen(targetId);
                if(link.classList.contains('nav-link')) {
                    document.querySelectorAll('.nav-link').forEach(nav => nav.classList.replace('text-brand-primary', 'text-brand-secondary'));
                    link.classList.replace('text-brand-secondary', 'text-brand-primary');
                }
                closeSidebar();
            });
        });
        
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('overlay');
        const openSidebarBtn = document.getElementById('open-sidebar');
        const closeSidebarBtn = document.getElementById('close-sidebar');
        const chatModal = document.getElementById('chat-modal');
        const openChatFab = document.getElementById('open-chat-fab');
        const closeChatModalBtn = document.getElementById('close-chat-modal');

        const openSidebar = () => { sidebar.classList.remove('-translate-x-full'); overlay.classList.remove('opacity-0', 'pointer-events-none'); };
        const closeSidebar = () => { sidebar.classList.add('-translate-x-full'); if (chatModal.classList.contains('opacity-0')) { overlay.classList.add('opacity-0', 'pointer-events-none'); }};
        
        const openChat = () => { chatModal.classList.remove('opacity-0', 'pointer-events-none', 'scale-95'); overlay.classList.remove('opacity-0', 'pointer-events-none'); };
        const closeChat = () => { chatModal.classList.add('opacity-0', 'pointer-events-none', 'scale-95'); if (sidebar.classList.contains('-translate-x-full')) { overlay.classList.add('opacity-0', 'pointer-events-none'); }};

        openSidebarBtn.addEventListener('click', openSidebar);
        closeSidebarBtn.addEventListener('click', closeSidebar);
        openChatFab.addEventListener('click', openChat);
        closeChatModalBtn.addEventListener('click', closeChat);
        
        overlay.addEventListener('click', () => {
            closeSidebar();
            closeChat();
        });
        
        showScreen('home-screen');
    });
    </script>
</body>
</html>

